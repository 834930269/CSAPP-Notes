> ***2021.10.01\***

------

## 1.7 The Operating System Manages the Hardware

操作系统是介于应用和硬件之间的一层软件。操作系统主要有两个功能：

- 保护硬件不被应用滥用；
- 为应用提供简单且统一的应用来屏蔽底层硬件的大相径庭。

### 1.7.1 Processes

进程是操作系统对运行程序的抽象。多个进程可以并发的运行在同一个操作系统上。

操作系统通过上下文切换来实现多进程并发。上下文包括程序计数器当前值、寄存器文件、主存中的内容。操作系统把控制权从当前进程转到新进程是会进行上下文切换，上下文切换的操作将当前进程的上下文保存，并回去新的进程的上下文，并将控制权交给新进程。新进程会从上次停止的地方开始。

新旧进程的过渡操作有操作系统内核（kernel）管理的，内核程序始终在主存中运行。内核不是一个独立的进程。是全部进程代码和数据的集合。

### 1.7.2 Threads

一个进程可以由多个控制单元组成，这些控制单元被称为线程。线程之间共享代码和全局变量。

### 1.7.3 Virtual Memory

虚拟内存是进程使用主存的一种抽象。每个进程的内存都是一致的，称为虚拟地址空间

Linux虚拟进程空间如下，从低地址开始：

- 程序代码和数据
- 堆（head）：malloc、free
- 共享库
- 栈（stack）：调用函数时增长、返回函数时收缩
- 内核虚拟内存

### 1.7.4 Files

文件是字节序列。所有的I/O设备都被看作是文件。