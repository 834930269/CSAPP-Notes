# 第九章 虚拟存储器

## 背景

1. 如何高效地利用主存？
   将 DRAM 作为虚拟存储器系统的缓存
2. 对于进程来说，如何向其提供一种抽象，从而简化对主存的操作？
   为每个进程提供了一致的地址空间
3. 如何保护每个进程的地址空间不被其他进程破坏？
   1. 对于进程而言，其不能直接与实际的物理空间交互
   2. 相比可以访问整个内存的特权模式，用户模式只能访问有限的内存
   3. 进程在尝试非法访问内存（越界访问）时，CPU 会产生异常，并安排操作系统的越界异常处理程序去处理，比如终止进程

## 9.1 ~ 9.3 节

1. 基于硬件的地址转换技术：将进程使用的内存地址重定位到实际的物理地址上
2. CPU 通过虚拟地址来访问主存：通过存储器管理单元（MMU）将虚拟地址（VA）翻译成物理地址（PA），而 MMU 又是通过存放在主存中的查询表来动态翻译 VA
3. 页表
   1. 一个页表条目（PTE）的数组，分为 a) 物理存储器上的地址 b) 磁盘上的地址 c) 未分配 三类
   2. 页命中
   3. 缺页（不命中）
      1. 触发缺页异常
	  2. 调用内核中的缺页异常处理程序
	  3. 按需页面调度
	  4. 换入和换出
4. 局部性
   局部性原则保证了在任意时刻，程序将往往活动在一个较小的活动页面集合上工作
5. 颠簸（thrashing）
   程序工作集的大小超出了物理存储器的大小，此时页面将不断地换进换出，这可能会导致程序运行得很慢
